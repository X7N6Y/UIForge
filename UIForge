local UIForge = {}

-- Variables
local ScreenSize = workspace.CurrentCamera.ViewportSize
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local player = Players.LocalPlayer

-- Create Main GUI Frame
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0.5, 0, 0.5, 0)
MainFrame.Position = UDim2.new(0.25, 0, 0.25, 0)
MainFrame.BackgroundColor3 = Color3.fromRGB(240, 240, 240)
MainFrame.Parent = player:WaitForChild("PlayerGui")

-- Create Toggle Button
local ToggleButton = Instance.new("TextButton")
ToggleButton.Size = UDim2.new(0, 50, 0, 50)
ToggleButton.Position = UDim2.new(0.95, -55, 0.05, 0)
ToggleButton.Text = "â˜°"
ToggleButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
ToggleButton.Parent = MainFrame

-- Create Close Button
local CloseButton = Instance.new("TextButton")
CloseButton.Size = UDim2.new(0, 50, 0, 50)
CloseButton.Position = UDim2.new(0.95, -55, 0.95, -55)
CloseButton.Text = "X"
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
CloseButton.Parent = MainFrame

-- Create Options Frame
local OptionsFrame = Instance.new("Frame")
OptionsFrame.Size = UDim2.new(1, 0, 1, 0)
OptionsFrame.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
OptionsFrame.Visible = false
OptionsFrame.Parent = MainFrame

-- Create Theme Toggle
local ThemeButton = Instance.new("TextButton")
ThemeButton.Size = UDim2.new(0.2, 0, 0.1, 0)
ThemeButton.Position = UDim2.new(0.4, 0, 0.4, 0)
ThemeButton.Text = "Toggle Theme"
ThemeButton.BackgroundColor3 = Color3.fromRGB(150, 150, 150)
ThemeButton.Parent = OptionsFrame

-- Functions
local function setTheme(theme)
    if theme == "dark" then
        MainFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        ToggleButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
        CloseButton.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    else
        MainFrame.BackgroundColor3 = Color3.fromRGB(240, 240, 240)
        ToggleButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
        CloseButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    end
end

local function toggleOptions()
    OptionsFrame.Visible = not OptionsFrame.Visible
end

-- Event Listeners
ToggleButton.MouseButton1Click:Connect(toggleOptions)

CloseButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
end)

ThemeButton.MouseButton1Click:Connect(function()
    local currentTheme = player:GetAttribute("Theme") or "light"
    local newTheme = currentTheme == "dark" and "light" or "dark"
    player:SetAttribute("Theme", newTheme)
    setTheme(newTheme)
end)

-- Draggable GUI Functionality
local dragToggle = nil
local dragStart = nil
local startPos = nil

MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragToggle = true
        dragStart = input.Position
        startPos = MainFrame.Position
    end
end)

MainFrame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragToggle = false
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement and dragToggle then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Print on Load
print("UIForge GUI successfully loaded!")

return UIForge